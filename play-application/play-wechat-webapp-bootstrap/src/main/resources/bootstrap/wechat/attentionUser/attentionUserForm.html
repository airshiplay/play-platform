<link type="text/css" rel="stylesheet" href="bootstrap/vendor/plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.min.css">
<link type="text/css" rel="stylesheet" href="bootstrap/vendor/plugins/select2/select2.min.css">
<link type="text/css" rel="stylesheet" href="//cdn.bootcss.com/bootstrap-fileinput/4.3.3/css/fileinput.min.css">

<section class="content-header">
	<h1>
		 关注用户列表 <small>开始管理 关注用户</small>
	</h1>
	<ol class="breadcrumb">
		<li><a href="#page/center/home"><i class="fa fa-home"></i> Home</a></li>
		<li><a href="#page/wechat/attentionUser/attentionUserList"><i class="glyphicon glyphicon-list"></i> ***列表</a></li>
		<li class="active" th:text="${attentionUser==null?'新建 关注用户':'编辑 关注用户'}">新建 关注用户</li>
	</ol>
</section>
<!-- Main content -->
<section class="content" th:inline="text">

	<div class="row">
		<div class="col-xs-12">

			<div class="box box-primary">
				<div class="box-header with-border">
					<h3 class="box-title" th:text="${attentionUser==null?'新建 关注用户':'编辑 关注用户'}">新建 关注用户</h3>
				</div>
				<!-- /.box-header -->
				<!-- form start -->
				<form role="form" class="attentionuser-form" action="/wechat/attentionUser/save">
					<input type="hidden" name="id" th:value="${attentionUser==null?'':attentionUser.id}" />
					<div class="box-body">
						<div class="form-group">
							<label for="openidInput">openid</label>
							<input type="text" name="openid" class="form-control" id="openidInput" placeholder="请填写openid"
								
		                  		th:value="${attentionUser==null?'':attentionUser.openid}"/>
						</div>
						<div class="form-group">
							<label for="nicknameInput">昵称</label>
							<input type="text" name="nickname" class="form-control" id="nicknameInput" placeholder="请填写nickname"
								 data-bv-notempty="true" data-bv-notempty-message="请填写nickname"data-bv-stringlength="true" data-bv-stringlength-min="2" data-bv-stringlength-max="50" data-bv-stringlength-message="个数必须在2和50之间"
								
		                  		th:value="${attentionUser==null?'':attentionUser.nickname}"/>
						</div>
						<div class="form-group">
							<label for="sexInput">性别</label>
							<input type="text" name="sex" class="form-control" id="sexInput" placeholder="请填写sex"
								
		                  		th:value="${attentionUser==null?'':attentionUser.sex}"/>
						</div>
						<div class="form-group">
							<label for="languageInput">语言</label>
							<input type="text" name="language" class="form-control" id="languageInput" placeholder="请填写language"
								
		                  		th:value="${attentionUser==null?'':attentionUser.language}"/>
						</div>
						<div class="form-group">
							<label for="cityInput">城市</label>
							<input type="text" name="city" class="form-control" id="cityInput" placeholder="请填写city"
								
		                  		th:value="${attentionUser==null?'':attentionUser.city}"/>
						</div>
						<div class="form-group">
							<label for="provinceInput">省份</label>
							<input type="text" name="province" class="form-control" id="provinceInput" placeholder="请填写province"
								
		                  		th:value="${attentionUser==null?'':attentionUser.province}"/>
						</div>
						<div class="form-group">
							<label for="countryInput">国家</label>
							<input type="text" name="country" class="form-control" id="countryInput" placeholder="请填写country"
								
		                  		th:value="${attentionUser==null?'':attentionUser.country}"/>
						</div>
		                <div class="form-group">
							<label for="headimgurlInput">头像</label>
							<input name="headimgurl" type="hidden" th:value="${attentionUser==null?'':attentionUser.headimgurl}">
							<input id="headimgurlInput" name="file" type="file" class="file-loading">
						</div>
						<div class="form-group">
							<label for="unionidInput">unionid</label>
							<input type="text" name="unionid" class="form-control" id="unionidInput" placeholder="请填写unionid"
								
		                  		th:value="${attentionUser==null?'':attentionUser.unionid}"/>
						</div>
						<div class="form-group">
							<label for="groupidInput">groupid</label>
							<input type="text" name="groupid" class="form-control" id="groupidInput" placeholder="请填写groupid"
								
		                  		th:value="${attentionUser==null?'':attentionUser.groupid}"/>
						</div>
						
					</div>
					<!-- /.box-body -->

					<div class="box-footer">
						<button type="button" class="btn btn-default" onclick="location.href='#/page/wechat/attentionUser/attentionUserList'">返回列表</button>
						<button type="submit" class="btn btn-primary pull-right">保存</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</section>

<script type="text/javascript">
	require([ "domReady","datetimepickerzh","select2zh","fileinputzh","kindeditor"], function(domReady) {
		domReady(function() {
			activeMenu("wechat_attentionuser_list");
			
			var headimgurlIcon = "[[${attentionUser==null?'':attentionUser.headimgurl}]]";
			var $headimgurlInput = $("#headimgurlInput");
			$headimgurlInput.fileinput({
				overwriteInitial : true,
				language : "zh",
				uploadUrl : base + "/center/multipart/upload",
				maxFileSize : 1500,
				showClose : false,
				showCaption : false,
				multiple : false,
				showUpload : false, // hide upload button
				showRemove : false, // hide remove button
				minFileCount : 1,
				maxFileCount : 1,
				elErrorContainer : '#kv-headimgurl-errors-1',
				msgErrorClass : 'alert alert-block alert-danger',
				defaultPreviewContent : headimgurlIcon&&headimgurlIcon!="" ?"<img src='"+headimgurlIcon+"' alt='头像' style='width:160px'>":"<img src='' alt='头像' style='width:160px'>",
				allowedFileTypes : [ "image" ]
			}).on("filebatchselected", function(event, files) {
				$headimgurlInput.fileinput("upload");
			}).on('fileuploaded', function(event, data, previewId, index) {
				var form = data.form, files = data.files, extra = data.extra, response = data.response, reader = data.reader;
				if (response.success) {
					var $form = $(".attentionuser-form");
					$form.find("input[name=headimgurl]").val(KindEditor.formatUrl(response.urls, 'absolute'));
				}
			});

			var $form = $(".attentionuser-form");		  
			$(".attentionuser-form").bootstrapValidator().on('success.form.bv', function(e) {
				e.preventDefault();
				var $form = $(e.target);
				var bv = $form.data('bootstrapValidator');
				console.log("");
				$.post($form.attr('action'), $form.serialize(), function(result) {
					if (result.success) {
						$.alert({
							title : false,
							closeIcon: true,
							content : "保存成功",
							confirmButton : "返回列表",
							confirm : function() {
								location.href = "#/page/wechat/attentionUser/attentionUserList";
							}
						});

					} else {
						$.alert({
							title : false,
							content : result.msg,
							confirmButton : "关闭"
						});
						$form.bootstrapValidator('disableSubmitButtons', false);
					}
				}, 'json');
			});
		});
	});
</script>